(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+fAT":function(t,e,a){var n={"./components/ExampleComponent.vue":"AEaB","./components/MapComponent.vue":"rlHA","./components/Rss.vue":"9oGP"};function i(t){var e=s(t);return a(e)}function s(t){if(!a.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=s,t.exports=i,i.id="+fAT"},"/u9J":function(t,e,a){(e=t.exports=a("I1BE")(!1)).i(a("hhfp"),""),e.i(a("bKdT"),""),e.i(a("FekW"),""),e.push([t.i,"\n.map-notification[data-v-a47e67c0] {\n   position: fixed;\n   bottom: 1rem;\n   z-index: 1002;\n   left: 1rem;\n   right: 1rem;\n}\n.your_custom_class[data-v-a47e67c0] .multiselect__option--highlight, .your_custom_class[data-v-a47e67c0] .multiselect__option::after {\n     background: var(--primary);\n}\n",""])},0:function(t,e,a){a("bUC5"),t.exports=a("pyCd")},"9Wh1":function(t,e,a){"use strict";a.r(e);var n=a("Vjiq");window._=a("LvDl");try{window.Popper=a("8L3F").default,window.$=window.jQuery=a("EVdn"),a("SYky")}catch(t){}window.axios=a("vDqi"),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var i=document.head.querySelector('meta[name="csrf-token"]');i?window.axios.defaults.headers.common["X-CSRF-TOKEN"]=i.content:console.error("CSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token"),window.Pusher=a("eC5B"),window.Echo=new n.a({broadcaster:"pusher",key:"14011b674484b7b9c2e8",cluster:"eu",encrypted:!0})},"9oGP":function(t,e,a){"use strict";a.r(e);var n={props:["title","date","source","link"]},i=a("KHd+"),s=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"small"},[a("p",[t.title?a("a",{attrs:{target:"_BLANK",href:t.link}},[t._v(t._s(t.title)+" ")]):t._e(),t._v(" "),t.date?a("small",[t._v(" "+t._s(t.date)+"\n            "),t.source?a("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.source)+" ")]):t._e()]):t._e()])])}),[],!1,null,null,null);e.default=s.exports},AEaB:function(t,e,a){"use strict";a.r(e);var n={mounted:function(){console.log("Component mounted.")}},i=a("KHd+"),s=Object(i.a)(n,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-md-8"},[e("div",{staticClass:"card card-default"},[e("div",{staticClass:"card-header"},[this._v("Example Component")]),this._v(" "),e("div",{staticClass:"card-body"},[this._v("\n                    I'm an example component.\n                ")])])])])])}],!1,null,null,null);e.default=s.exports},Wdb6:function(t,e,a){"use strict";var n=a("XqlD");a.n(n).a},XqlD:function(t,e,a){var n=a("/u9J");"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(n,i);n.locals&&(t.exports=n.locals)},bUC5:function(t,e,a){"use strict";a.r(e);var n=a("4R65");a("9Wh1"),window.timeago=a("xyvv"),window.Vue=a("XuX8"),delete n.Icon.Default.prototype._getIconUrl,n.Icon.Default.mergeOptions({iconRetinaUrl:a("WE1v"),iconUrl:a("Y5fm"),shadowUrl:a("4rkx")});var i=a("+fAT");i.keys().map((function(t){return Vue.component(t.split("/").pop().split(".")[0],i(t).default)}));new Vue({el:"#app"})},pyCd:function(t,e){},rlHA:function(t,e,a){"use strict";a.r(e);var n=a("JpmB"),i=a("pArE"),s=a("Tith"),o=a("9g/y"),r=a("+7pQ"),l=a("Hrto"),c=a("L2ck"),u=a("yp/A"),h=a.n(u),m=a("jl8+"),d=a.n(m);!function(t){var e,a=(e=t.documentMode,"onhashchange"in t&&(void 0===e||e>7));L.Hash=function(t){this.onHashChange=L.Util.bind(this.onHashChange,this),t&&this.init(t)},L.Hash.parseHash=function(t){0===t.indexOf("#")&&(t=t.substr(1));var e=t.split("/");if(3==e.length){var a=parseInt(e[0],10),n=parseFloat(e[1]),i=parseFloat(e[2]);return!(isNaN(a)||isNaN(n)||isNaN(i))&&{center:new L.LatLng(n,i),zoom:a}}return!1},L.Hash.formatHash=function(t){var e=t.getCenter(),a=t.getZoom(),n=Math.max(0,Math.ceil(Math.log(a)/Math.LN2));return"#"+[a,e.lat.toFixed(n),e.lng.toFixed(n)].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(t){this.map=t,this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(t){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var t=this.formatHash(this.map);this.lastHash!=t&&(location.replace(t),this.lastHash=t)},movingMap:!1,update:function(){var t=location.hash;if(t!==this.lastHash){var e=this.parseHash(t);e?(this.movingMap=!0,this.map.setView(e.center,e.zoom),this.movingMap=!1):this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var t=this;this.changeTimeout=setTimeout((function(){t.update(),t.changeTimeout=null}),this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend",this.onMapMove,this),a?L.DomEvent.addListener(t,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend",this.onMapMove,this),a?L.DomEvent.removeListener(t,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1}},L.hash=function(t){return new L.Hash(t)},L.Map.prototype.addHash=function(){this._hash=L.hash(this)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window);var p={components:{LMap:n.a,LTileLayer:i.a,LMarker:s.a,LPopup:o.a,"l-locatecontrol":c.a,LIcon:r.a,"l-marker-cluster":h.a,LLayerGroup:l.a,Multiselect:d.a},data:function(){return{zoom:4,center:L.latLng(43.704,7.3111),url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}{r}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19,minZoom:3,incidents:[],categories:[],new_message:"",submit_data:{lat:0,lng:0,category:0,category_name:"",loading:!1}}},mounted:function(){var t=this;new L.Hash(this.$refs.map.mapObject),axios.get("/api/incidents").then((function(e){return t.incidents=e.data})),axios.get("/api/categories").then((function(e){return t.categories=e.data.data})),Echo.channel("incidents").listen("IncidentCreated",(function(e){t.incidents.push(e.incident),t.new_message=""+e.incident.category.name,setTimeout(function(){this.new_message=""}.bind(t),5e3)}))},computed:{incidentsCount:function(){return this.incidents.length}},watch:{incidentsCount:function(t){}},methods:{addMarker:function(t){this.$refs.hello_popup.mapObject.openPopup(t.latlng),this.submit_data.lat=t.latlng.lat,this.submit_data.lng=t.latlng.lng,this.$refs.map.mapObject.flyTo(t.latlng,18)},openPopup:function(t){timeago.render(document.querySelectorAll(".timestamp"))},addTag:function(t){var e={category_id:-1,name:t,icon:"/images/vendor/leaflet/dist/marker-icon-2x.png"};this.categories.push(e),this.submit_data.fullCategory=e,this.submit_data.category=e.category_id,this.submit_data.category_name=e.name},handleSelectInput:function(t){this.submit_data.fullCategory=t,this.submit_data.category=t.id,this.submit_data.category_name=t.name},submitForm:function(t){var e=this;this.submit_data.loading=!0,axios.post("/api/incidents",this.submit_data).then((function(t){e.$refs.hello_popup.mapObject.closePopup(),e.submit_data.loading=!1})).catch((function(t){e.submit_data.loading=!1,console.log(t),alert("You must be logged in and have permssion to post. Please log in or register.")}))}}},f=(a("Wdb6"),a("KHd+")),g=Object(f.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("l-map",{ref:"map",staticStyle:{width:"100%",height:"71vh"},attrs:{zoom:t.zoom,center:t.center},on:{contextmenu:t.addMarker}},[a("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}}),t._v(" "),a("l-locatecontrol"),t._v(" "),a("l-layer-group",{ref:"hello_popup"},[a("l-popup",[a("form",{attrs:{method:"POST",id:"reportForm",action:"/incidents",disabled:!t.submit_data.category_name},on:{submit:function(e){return e.preventDefault(),t.submitForm()}}},[a("label",{staticClass:"my-1 mr-2"},[t._v("Report incident:")]),t._v(" "),a("multiselect",{staticClass:"your_custom_class",staticStyle:{width:"250px"},attrs:{"deselect-label":"Can't remove this value","track-by":"name",label:"name",placeholder:"Select one",options:t.categories,searchable:!0,"allow-empty":!1,taggable:!0,"show-labels":!1,required:""},on:{input:t.handleSelectInput,tag:t.addTag},scopedSlots:t._u([{key:"singleLabel",fn:function(e){var n=e.option;return[a("strong",[t._v(t._s(n.name))])]}},{key:"option",fn:function(e){return[a("img",{staticClass:"rounded img-thumbnail mr-1",staticStyle:{position:"initial"},attrs:{height:"25",width:"25",src:e.option.icon,alt:""}}),t._v(t._s(e.option.name)+"\n            ")]}}]),model:{value:t.submit_data.fullCategory,callback:function(e){t.$set(t.submit_data,"fullCategory",e)},expression:"submit_data.fullCategory"}}),t._v(" "),a("input",{staticClass:"btn btn-primary btn-sm my-1",attrs:{type:"submit",value:"Report",disabled:t.submit_data.loading||!t.submit_data.category_name}})],1)])],1),t._v(" "),a("l-marker-cluster",t._l(t.incidents,(function(e){return a("l-marker",{key:e.id+"marker",attrs:{"lat-lng":e.location.coordinates}},[a("l-icon",{attrs:{"icon-url":e.category.icon,"icon-size":[20,20],"icon-anchor":[10,10]}}),t._v(" "),a("l-popup",{on:{ready:t.openPopup}},[a("b",[t._v(t._s(e.category.name)+" reported in the area.")]),a("br"),t._v("Last report: "),a("span",{staticClass:"timestamp",attrs:{datetime:e.updated_at}},[t._v(t._s(e.updated_at))]),t._v("."),a("br")])],1)})),1)],1),t._v(" "),t.new_message?a("div",{staticClass:"alert alert-primary map-notification",attrs:{role:"alert"}},[a("h4",{staticClass:"alert-heading"},[t._v("A new incident was reported")]),t._v(" "),a("p",{staticClass:"mb-0"},[t._v(t._s(t.new_message))])]):t._e()],1)}),[],!1,null,"a47e67c0",null);e.default=g.exports}},[[0,1,2]]]);
//# sourceMappingURL=app.js.map